<!DOCTYPE html>
<html>
<head>
    <title>Todo App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>
<body>
    <div class="container mt-5">
        <div class="row align-items-center">
            <div class="col-md-6">
                <h1>Todo App</h1>
            </div>
            <div class="col-md-6 text-end">
                Results Per Page: <select id="pageItems">
                </select>
                <br/>
                Search: <input id="tableSearch" type="text" />
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <table id="dataTable" class="table table-striped table-hover table-sort table-arrows">
                    <thead>
                        <tr>
                            <th class="header">ID</th>
                            <th class="header">Title</th>
                            <th class="header">Completed</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Table rows will be dynamically added here -->
                    </tbody>
                </table>
                <div id="pageLinks"></div>
            </div>
        </div>
        <div class="row"></div>
            <a href="https://github.com/trek88/Todo-Application">Todo Application Git Repository</a>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/table-sort-js/table-sort.min.js"></script>

    <script>
        $(document).ready(function() {
    
            // Function to fetch data and populate the table
            // This can be in a separate file or embedded here

            var itemsPerPage = 10;

            $.ajax({
                url:'https://jsonplaceholder.typicode.com/todos',
                dataType: 'json',
                success: function(data){
                    
                    var itemCount = 0;

                    $.each(data, function(key, val) {
                        itemCount++; 
                        newRow = "<tr " + (itemCount>itemsPerPage?'class="d-none"':"") + ">\n" +
                                 "  <td>" + val["id"] + "</td>/n" +
                                 "  <td>" + val["title"] + "</td>/n" +
                                 "  <td>" + (val["completed"]?"Yes":"No") + "</td>/n" +
                                 "</tr>"; 
                                    
                        $("#dataTable tbody").append(newRow);

                        itemOption = "<option " + (itemCount==itemsPerPage?'selected ':"") + ">" +  itemCount + "</option>\n";
                        $("#pageItems").append(itemOption);

                        if ((itemCount-1) % itemsPerPage == 0) {
                            pageNumber = (itemCount-1+itemsPerPage)/itemsPerPage;
                            pageLink = "<a href='#" + pageNumber + "'>" + pageNumber + "</a>";
                            $("#pageLinks").append(pageLink);
                        }
                         
                    });

                }
            });

            $("#tableSearch").on("keyup", function() {
                var searchTerm = $(this).val().toLowerCase();
                console.log(searchTerm);
                $("#dataTable tr").filter(function() {
                    $(this).toggle($(this).text().toLowerCase().indexOf(searchTerm) > -1);
                });
            });

        });
    </script>
</body>
</html>